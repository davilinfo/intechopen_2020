{"ast":null,"code":"'use strict';\n\nvar IDENTIFIER = /^[a-z_$][a-z0-9_$-]*$/i;\n\nvar customRuleCode = require('./dotjs/custom');\n\nvar metaSchema = require('./refs/json-schema-draft-07.json');\n\nmodule.exports = {\n  add: addKeyword,\n  get: getKeyword,\n  remove: removeKeyword,\n  validate: validateKeyword\n};\nvar definitionSchema = {\n  definitions: {\n    simpleTypes: metaSchema.definitions.simpleTypes\n  },\n  type: 'object',\n  dependencies: {\n    schema: ['validate'],\n    $data: ['validate'],\n    statements: ['inline'],\n    valid: {\n      not: {\n        required: ['macro']\n      }\n    }\n  },\n  properties: {\n    type: metaSchema.properties.type,\n    schema: {\n      type: 'boolean'\n    },\n    statements: {\n      type: 'boolean'\n    },\n    dependencies: {\n      type: 'array',\n      items: {\n        type: 'string'\n      }\n    },\n    metaSchema: {\n      type: 'object'\n    },\n    modifying: {\n      type: 'boolean'\n    },\n    valid: {\n      type: 'boolean'\n    },\n    $data: {\n      type: 'boolean'\n    },\n    async: {\n      type: 'boolean'\n    },\n    errors: {\n      anyOf: [{\n        type: 'boolean'\n      }, {\n        const: 'full'\n      }]\n    }\n  }\n};\n/**\r\n * Define custom keyword\r\n * @this  Ajv\r\n * @param {String} keyword custom keyword, should be unique (including different from all standard, custom and macro keywords).\r\n * @param {Object} definition keyword definition object with properties `type` (type(s) which the keyword applies to), `validate` or `compile`.\r\n * @return {Ajv} this for method chaining\r\n */\n\nfunction addKeyword(keyword, definition) {\n  /* jshint validthis: true */\n\n  /* eslint no-shadow: 0 */\n  var RULES = this.RULES;\n  if (RULES.keywords[keyword]) throw new Error('Keyword ' + keyword + ' is already defined');\n  if (!IDENTIFIER.test(keyword)) throw new Error('Keyword ' + keyword + ' is not a valid identifier');\n\n  if (definition) {\n    this.validateKeyword(definition, true);\n    var dataType = definition.type;\n\n    if (Array.isArray(dataType)) {\n      for (var i = 0; i < dataType.length; i++) _addRule(keyword, dataType[i], definition);\n    } else {\n      _addRule(keyword, dataType, definition);\n    }\n\n    var metaSchema = definition.metaSchema;\n\n    if (metaSchema) {\n      if (definition.$data && this._opts.$data) {\n        metaSchema = {\n          anyOf: [metaSchema, {\n            '$ref': 'https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#'\n          }]\n        };\n      }\n\n      definition.validateSchema = this.compile(metaSchema, true);\n    }\n  }\n\n  RULES.keywords[keyword] = RULES.all[keyword] = true;\n\n  function _addRule(keyword, dataType, definition) {\n    var ruleGroup;\n\n    for (var i = 0; i < RULES.length; i++) {\n      var rg = RULES[i];\n\n      if (rg.type == dataType) {\n        ruleGroup = rg;\n        break;\n      }\n    }\n\n    if (!ruleGroup) {\n      ruleGroup = {\n        type: dataType,\n        rules: []\n      };\n      RULES.push(ruleGroup);\n    }\n\n    var rule = {\n      keyword: keyword,\n      definition: definition,\n      custom: true,\n      code: customRuleCode,\n      implements: definition.implements\n    };\n    ruleGroup.rules.push(rule);\n    RULES.custom[keyword] = rule;\n  }\n\n  return this;\n}\n/**\r\n * Get keyword\r\n * @this  Ajv\r\n * @param {String} keyword pre-defined or custom keyword.\r\n * @return {Object|Boolean} custom keyword definition, `true` if it is a predefined keyword, `false` otherwise.\r\n */\n\n\nfunction getKeyword(keyword) {\n  /* jshint validthis: true */\n  var rule = this.RULES.custom[keyword];\n  return rule ? rule.definition : this.RULES.keywords[keyword] || false;\n}\n/**\r\n * Remove keyword\r\n * @this  Ajv\r\n * @param {String} keyword pre-defined or custom keyword.\r\n * @return {Ajv} this for method chaining\r\n */\n\n\nfunction removeKeyword(keyword) {\n  /* jshint validthis: true */\n  var RULES = this.RULES;\n  delete RULES.keywords[keyword];\n  delete RULES.all[keyword];\n  delete RULES.custom[keyword];\n\n  for (var i = 0; i < RULES.length; i++) {\n    var rules = RULES[i].rules;\n\n    for (var j = 0; j < rules.length; j++) {\n      if (rules[j].keyword == keyword) {\n        rules.splice(j, 1);\n        break;\n      }\n    }\n  }\n\n  return this;\n}\n/**\r\n * Validate keyword definition\r\n * @this  Ajv\r\n * @param {Object} definition keyword definition object.\r\n * @param {Boolean} throwError true to throw exception if definition is invalid\r\n * @return {boolean} validation result\r\n */\n\n\nfunction validateKeyword(definition, throwError) {\n  validateKeyword.errors = null;\n  var v = this._validateKeyword = this._validateKeyword || this.compile(definitionSchema, true);\n  if (v(definition)) return true;\n  validateKeyword.errors = v.errors;\n  if (throwError) throw new Error('custom keyword definition is invalid: ' + this.errorsText(v.errors));else return false;\n}","map":{"version":3,"sources":["C:/PoC/restaurant_sidechain/node_modules/@liskhq/lisk-validator/node_modules/ajv/lib/keyword.js"],"names":["IDENTIFIER","customRuleCode","require","metaSchema","module","exports","add","addKeyword","get","getKeyword","remove","removeKeyword","validate","validateKeyword","definitionSchema","definitions","simpleTypes","type","dependencies","schema","$data","statements","valid","not","required","properties","items","modifying","async","errors","anyOf","const","keyword","definition","RULES","keywords","Error","test","dataType","Array","isArray","i","length","_addRule","_opts","validateSchema","compile","all","ruleGroup","rg","rules","push","rule","custom","code","implements","j","splice","throwError","v","_validateKeyword","errorsText"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nvar IDENTIFIER = /^[a-z_$][a-z0-9_$-]*$/i;\r\nvar customRuleCode = require('./dotjs/custom');\r\nvar metaSchema = require('./refs/json-schema-draft-07.json');\r\n\r\nmodule.exports = {\r\n  add: addKeyword,\r\n  get: getKeyword,\r\n  remove: removeKeyword,\r\n  validate: validateKeyword\r\n};\r\n\r\nvar definitionSchema = {\r\n  definitions: {\r\n    simpleTypes: metaSchema.definitions.simpleTypes\r\n  },\r\n  type: 'object',\r\n  dependencies: {\r\n    schema: ['validate'],\r\n    $data: ['validate'],\r\n    statements: ['inline'],\r\n    valid: {not: {required: ['macro']}}\r\n  },\r\n  properties: {\r\n    type: metaSchema.properties.type,\r\n    schema: {type: 'boolean'},\r\n    statements: {type: 'boolean'},\r\n    dependencies: {\r\n      type: 'array',\r\n      items: {type: 'string'}\r\n    },\r\n    metaSchema: {type: 'object'},\r\n    modifying: {type: 'boolean'},\r\n    valid: {type: 'boolean'},\r\n    $data: {type: 'boolean'},\r\n    async: {type: 'boolean'},\r\n    errors: {\r\n      anyOf: [\r\n        {type: 'boolean'},\r\n        {const: 'full'}\r\n      ]\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Define custom keyword\r\n * @this  Ajv\r\n * @param {String} keyword custom keyword, should be unique (including different from all standard, custom and macro keywords).\r\n * @param {Object} definition keyword definition object with properties `type` (type(s) which the keyword applies to), `validate` or `compile`.\r\n * @return {Ajv} this for method chaining\r\n */\r\nfunction addKeyword(keyword, definition) {\r\n  /* jshint validthis: true */\r\n  /* eslint no-shadow: 0 */\r\n  var RULES = this.RULES;\r\n  if (RULES.keywords[keyword])\r\n    throw new Error('Keyword ' + keyword + ' is already defined');\r\n\r\n  if (!IDENTIFIER.test(keyword))\r\n    throw new Error('Keyword ' + keyword + ' is not a valid identifier');\r\n\r\n  if (definition) {\r\n    this.validateKeyword(definition, true);\r\n\r\n    var dataType = definition.type;\r\n    if (Array.isArray(dataType)) {\r\n      for (var i=0; i<dataType.length; i++)\r\n        _addRule(keyword, dataType[i], definition);\r\n    } else {\r\n      _addRule(keyword, dataType, definition);\r\n    }\r\n\r\n    var metaSchema = definition.metaSchema;\r\n    if (metaSchema) {\r\n      if (definition.$data && this._opts.$data) {\r\n        metaSchema = {\r\n          anyOf: [\r\n            metaSchema,\r\n            { '$ref': 'https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#' }\r\n          ]\r\n        };\r\n      }\r\n      definition.validateSchema = this.compile(metaSchema, true);\r\n    }\r\n  }\r\n\r\n  RULES.keywords[keyword] = RULES.all[keyword] = true;\r\n\r\n\r\n  function _addRule(keyword, dataType, definition) {\r\n    var ruleGroup;\r\n    for (var i=0; i<RULES.length; i++) {\r\n      var rg = RULES[i];\r\n      if (rg.type == dataType) {\r\n        ruleGroup = rg;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!ruleGroup) {\r\n      ruleGroup = { type: dataType, rules: [] };\r\n      RULES.push(ruleGroup);\r\n    }\r\n\r\n    var rule = {\r\n      keyword: keyword,\r\n      definition: definition,\r\n      custom: true,\r\n      code: customRuleCode,\r\n      implements: definition.implements\r\n    };\r\n    ruleGroup.rules.push(rule);\r\n    RULES.custom[keyword] = rule;\r\n  }\r\n\r\n  return this;\r\n}\r\n\r\n\r\n/**\r\n * Get keyword\r\n * @this  Ajv\r\n * @param {String} keyword pre-defined or custom keyword.\r\n * @return {Object|Boolean} custom keyword definition, `true` if it is a predefined keyword, `false` otherwise.\r\n */\r\nfunction getKeyword(keyword) {\r\n  /* jshint validthis: true */\r\n  var rule = this.RULES.custom[keyword];\r\n  return rule ? rule.definition : this.RULES.keywords[keyword] || false;\r\n}\r\n\r\n\r\n/**\r\n * Remove keyword\r\n * @this  Ajv\r\n * @param {String} keyword pre-defined or custom keyword.\r\n * @return {Ajv} this for method chaining\r\n */\r\nfunction removeKeyword(keyword) {\r\n  /* jshint validthis: true */\r\n  var RULES = this.RULES;\r\n  delete RULES.keywords[keyword];\r\n  delete RULES.all[keyword];\r\n  delete RULES.custom[keyword];\r\n  for (var i=0; i<RULES.length; i++) {\r\n    var rules = RULES[i].rules;\r\n    for (var j=0; j<rules.length; j++) {\r\n      if (rules[j].keyword == keyword) {\r\n        rules.splice(j, 1);\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  return this;\r\n}\r\n\r\n\r\n/**\r\n * Validate keyword definition\r\n * @this  Ajv\r\n * @param {Object} definition keyword definition object.\r\n * @param {Boolean} throwError true to throw exception if definition is invalid\r\n * @return {boolean} validation result\r\n */\r\nfunction validateKeyword(definition, throwError) {\r\n  validateKeyword.errors = null;\r\n  var v = this._validateKeyword = this._validateKeyword\r\n                                  || this.compile(definitionSchema, true);\r\n\r\n  if (v(definition)) return true;\r\n  validateKeyword.errors = v.errors;\r\n  if (throwError)\r\n    throw new Error('custom keyword definition is invalid: '  + this.errorsText(v.errors));\r\n  else\r\n    return false;\r\n}\r\n"]},"metadata":{},"sourceType":"script"}
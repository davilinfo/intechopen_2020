{"ast":null,"code":"var _jsxFileName = \"C:\\\\PoC\\\\restaurant_sidechain\\\\web\\\\src\\\\components\\\\FormPayment.js\";\nimport React, { useState, useEffect, Component } from 'react';\nimport api from '../services/api';\nimport '../styles.css';\n\nconst FoodTransaction = require(\"../FoodTransaction\");\n\nconst cryptography = require('@liskhq/lisk-cryptography');\n\nconst transaction = require(\"@liskhq/lisk-transactions\");\n\nclass FormPayment extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = event => {\n      let name = event.target.name;\n      let val = event.target.value;\n      this.setState({\n        [name]: val\n      });\n    };\n\n    this.onSubmit = async transaction => {\n      console.log(transaction);\n      let order = await api.post('/clientPayment', {\n        transaction: transaction,\n        networkid: 'identifier'\n      });\n      console.log(order);\n    };\n\n    this.handleSubmit = async e => {\n      e.preventDefault();\n\n      if (this.state.orderstring !== null && this.state.orderstring !== undefined) {\n        this.state.orderstring = this.state.orderstring.split(\"&\");\n      }\n\n      const username = await api.post(\"/cryptography\", {\n        text: this.state.orderstring[5].split('=')[1]\n      });\n      const phone = await api.post(\"/cryptography\", {\n        text: this.state.orderstring[6].split('=')[1]\n      });\n      const deliveryaddress = await api.post(\"/cryptography\", {\n        text: this.state.orderstring[7].split('=')[1]\n      });\n      let observation = \"\";\n\n      if (this.state.orderstring[8] !== undefined) {\n        observation = await api.post(\"/cryptography\", {\n          text: this.state.orderstring[8].split('=')[1]\n        });\n      }\n\n      const publicKey = cryptography.getPrivateAndPublicKeyFromPassphrase(this.state.passphrase).publicKey;\n      /*const clientData = cryptography.encryptMessageWithPassphrase(\r\n          this.state.orderstring[5].split('=')[1].concat(' ***Field*** ')\r\n          .concat(this.state.orderstring[6].split('=')[1]).concat(' ***Field*** ')\r\n          .concat(this.state.orderstring[7].split('=')[1]).concat(' ***Field*** ')\r\n          .concat(this.state.orderstring[8].split('=')[1]),\r\n          this.state.passphrase,\r\n          publicKey\r\n          );   */\n\n      const networkIdentifier = cryptography.getNetworkIdentifier(\"23ce0366ef0a14a91e5fd4b1591fc880ffbef9d988ff8bebf8f3666b0c09597d\", \"Lisk\"); //const encryptedclient= cryptography.encryptMessageWithPassphrase(passphrase, passphrase, orderstring[9].split('=')[1]);        \n\n      const txFood = new FoodTransaction({\n        asset: {\n          /*name: this.state.orderstring[2].split('=')[1],\r\n          description: this.state.orderstring[2].split('=')[1],\r\n          username: username.data.response,\r\n          phone: phone.data.response,\r\n          deliveryaddress: deliveryaddress.data.response,\r\n          foodType: this.state.orderstring[3].split('=')[1],\r\n          observation: observation.data !== undefined ? observation.data.response : \"\",\r\n          clientData: clientData.encryptedMessage,\r\n          clientNonce: clientData.nonce,*/\n          amount: this.state.orderstring[1].split('=')[1].toString(),\n          recipientId: this.state.orderstring[0].split('=')[1] //restaurant lisk address\n          //key: encryptedclient.encryptedMessage,\n          //keynonce: encryptedclient.nonce,\n          //clientpublickey: cryptography.getAddressAndPublicKeyFromPassphrase(this.state.passphrase).publicKey\n\n        },\n        timestamp: transaction.utils.getTimeFromBlockchainEpoch(new Date()),\n        networkIdentifier: networkIdentifier\n      });\n      txFood.sign(this.state.passphrase);\n      alert(txFood);\n      console.log(txFood);\n      await this.onSubmit(txFood);\n    };\n\n    this.state = {\n      passphrase: '',\n      orderstring: props.orderstring,\n      response: {\n        meta: {\n          status: false\n        }\n      }\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"app\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"content\",\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      method: \"Post\",\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 25\n      }\n    }, \"Your Lisk Passphrase\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      id: \"passphrase\",\n      name: \"passphrase\",\n      required: true,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 25\n      }\n    }, \"copy this passphrase and test above if desired: creek own stem final gate scrub live shallow stage host concert they\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 25\n      }\n    }, \"Order\")))));\n  }\n\n}\n\nexport default FormPayment;","map":{"version":3,"sources":["C:/PoC/restaurant_sidechain/web/src/components/FormPayment.js"],"names":["React","useState","useEffect","Component","api","FoodTransaction","require","cryptography","transaction","FormPayment","constructor","props","handleChange","event","name","target","val","value","setState","onSubmit","console","log","order","post","networkid","handleSubmit","e","preventDefault","state","orderstring","undefined","split","username","text","phone","deliveryaddress","observation","publicKey","getPrivateAndPublicKeyFromPassphrase","passphrase","networkIdentifier","getNetworkIdentifier","txFood","asset","amount","toString","recipientId","timestamp","utils","getTimeFromBlockchainEpoch","Date","sign","alert","response","meta","status","render"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Component } from 'react';\r\nimport api from '../services/api';\r\nimport '../styles.css';\r\nconst FoodTransaction = require( \"../FoodTransaction\");\r\n\r\nconst cryptography = require('@liskhq/lisk-cryptography');\r\nconst transaction = require(\"@liskhq/lisk-transactions\");\r\n\r\nclass FormPayment extends Component{\r\n    constructor (props){        \r\n        super(props);\r\n\r\n        this.state = {\r\n            passphrase: '',\r\n            orderstring: props.orderstring,\r\n            response: { meta: { status: false }},\r\n        }\r\n    }\r\n    \r\n    handleChange = (event) => {\r\n        let name = event.target.name;\r\n        let val = event.target.value;\r\n        this.setState({[name]: val});\r\n    };       \r\n    \r\n    onSubmit = async (transaction) =>\r\n    {\r\n        console.log(transaction);\r\n        let order = await api.post('/clientPayment', {transaction: transaction, networkid: 'identifier'});\r\n        console.log(order);        \r\n    }\r\n\r\n    handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n                \r\n        if (this.state.orderstring !== null && this.state.orderstring !== undefined){    \r\n            this.state.orderstring = this.state.orderstring.split(\"&\");                                      \r\n        }\r\n\r\n        const username = await api.post(\"/cryptography\", { text: this.state.orderstring[5].split('=')[1] });\r\n        const phone = await api.post(\"/cryptography\", { text: this.state.orderstring[6].split('=')[1] });\r\n        const deliveryaddress = await api.post(\"/cryptography\", { text: this.state.orderstring[7].split('=')[1] });\r\n        let observation = \"\";\r\n        if (this.state.orderstring[8] !== undefined){\r\n            observation = await api.post(\"/cryptography\", { text: this.state.orderstring[8].split('=')[1] });\r\n        }        \r\n        \r\n        const publicKey = cryptography.getPrivateAndPublicKeyFromPassphrase(this.state.passphrase).publicKey;\r\n\r\n        /*const clientData = cryptography.encryptMessageWithPassphrase(\r\n            this.state.orderstring[5].split('=')[1].concat(' ***Field*** ')\r\n            .concat(this.state.orderstring[6].split('=')[1]).concat(' ***Field*** ')\r\n            .concat(this.state.orderstring[7].split('=')[1]).concat(' ***Field*** ')\r\n            .concat(this.state.orderstring[8].split('=')[1]),\r\n            this.state.passphrase,\r\n            publicKey\r\n            );   */                         \r\n\r\n        const networkIdentifier = cryptography.getNetworkIdentifier(\r\n            \"23ce0366ef0a14a91e5fd4b1591fc880ffbef9d988ff8bebf8f3666b0c09597d\",\r\n            \"Lisk\",\r\n        );       \r\n\r\n        //const encryptedclient= cryptography.encryptMessageWithPassphrase(passphrase, passphrase, orderstring[9].split('=')[1]);        \r\n        \r\n        const txFood = new FoodTransaction({\r\n            asset: {\r\n                /*name: this.state.orderstring[2].split('=')[1],\r\n                description: this.state.orderstring[2].split('=')[1],\r\n                username: username.data.response,\r\n                phone: phone.data.response,\r\n                deliveryaddress: deliveryaddress.data.response,\r\n                foodType: this.state.orderstring[3].split('=')[1],\r\n                observation: observation.data !== undefined ? observation.data.response : \"\",\r\n                clientData: clientData.encryptedMessage,\r\n                clientNonce: clientData.nonce,*/\r\n                amount: this.state.orderstring[1].split('=')[1].toString(),\r\n                recipientId: this.state.orderstring[0].split('=')[1], //restaurant lisk address\r\n                //key: encryptedclient.encryptedMessage,\r\n                //keynonce: encryptedclient.nonce,\r\n                //clientpublickey: cryptography.getAddressAndPublicKeyFromPassphrase(this.state.passphrase).publicKey\r\n            },                \r\n            timestamp: transaction.utils.getTimeFromBlockchainEpoch(new Date()),\r\n            networkIdentifier: networkIdentifier\r\n        });             \r\n\r\n        txFood.sign(this.state.passphrase);                \r\n\r\n        alert(txFood);\r\n        console.log(txFood);        \r\n\r\n        await this.onSubmit(txFood);                       \r\n    }    \r\n\r\n    render() {\r\n    return (\r\n        <div id=\"app\">\r\n            <div id=\"content\" align=\"center\">                \r\n                <form method=\"Post\" onSubmit={this.handleSubmit}>                                  \r\n                    <div>\r\n                        <label>Your Lisk Passphrase</label>\r\n                    </div>\r\n                    <div>\r\n                        <input type=\"password\" id=\"passphrase\" name=\"passphrase\" required onChange={this.handleChange}/>\r\n                    </div>\r\n                    <div>\r\n                        <label>copy this passphrase and test above if desired: creek own stem final gate scrub live shallow stage host concert they</label>\r\n                    </div>\r\n                    <div>\r\n                        <button type=\"submit\">Order</button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n    }\r\n}\r\n\r\nexport default FormPayment;\r\n"]},"metadata":{},"sourceType":"module"}
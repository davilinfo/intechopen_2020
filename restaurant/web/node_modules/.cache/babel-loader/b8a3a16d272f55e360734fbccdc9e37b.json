{"ast":null,"code":"var _jsxFileName = \"C:\\\\PoC\\\\restaurant_sidechain\\\\web\\\\src\\\\components\\\\FormPayment.js\";\nimport React, { useState, useEffect, Component } from 'react';\nimport api from '../services/api';\nimport '../styles.css';\n\nconst cryptography = require('@liskhq/lisk-cryptography');\n\nconst transaction = require(\"@liskhq/lisk-transactions\");\n\nconst FoodRequest = require(\"liskrestaurant_transactions\");\n\nclass FormPayment extends Component {\n  constructor(props) {\n    this.state = {\n      passphrase: '',\n      orderstring: props.orderstring,\n      response: {\n        meta: {\n          status: false\n        }\n      }\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"app\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"content\",\n      align: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 25\n      }\n    }, \"Your Lisk Passphrase\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      id: \"passphrase\",\n      name: \"passphrase\",\n      required: true,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 25\n      }\n    }, \"copy this passphrase and test above if desired: creek own stem final gate scrub live shallow stage host concert they\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 25\n      }\n    }, \"Order\")))));\n  }\n\n}\n\nexport default FormPayment;","map":{"version":3,"sources":["C:/PoC/restaurant_sidechain/web/src/components/FormPayment.js"],"names":["React","useState","useEffect","Component","api","cryptography","require","transaction","FoodRequest","FormPayment","constructor","props","state","passphrase","orderstring","response","meta","status","render","handleSubmit","handleChange"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,SAArC,QAAsD,OAAtD;AACA,OAAOC,GAAP,MAAgB,iBAAhB;AACA,OAAO,eAAP;;AAEA,MAAMC,YAAY,GAAGC,OAAO,CAAC,2BAAD,CAA5B;;AACA,MAAMC,WAAW,GAAGD,OAAO,CAAC,2BAAD,CAA3B;;AACA,MAAME,WAAW,GAAGF,OAAO,CAAC,6BAAD,CAA3B;;AAEA,MAAMG,WAAN,SAA0BN,SAA1B,CAAmC;AAC/BO,EAAAA,WAAW,CAAEC,KAAF,EAAQ;AAEf,SAAKC,KAAL,GAAa;AACTC,MAAAA,UAAU,EAAE,EADH;AAETC,MAAAA,WAAW,EAAEH,KAAK,CAACG,WAFV;AAGTC,MAAAA,QAAQ,EAAE;AAAEC,QAAAA,IAAI,EAAE;AAAEC,UAAAA,MAAM,EAAE;AAAV;AAAR;AAHD,KAAb;AAKH;;AAsEDC,EAAAA,MAAM,GAAG;AACT,wBACI;AAAK,MAAA,EAAE,EAAC,KAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,EAAE,EAAC,SAAR;AAAkB,MAAA,KAAK,EAAC,QAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAM,MAAA,QAAQ,EAAEC,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BADJ,CADJ,eAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAO,MAAA,IAAI,EAAC,UAAZ;AAAuB,MAAA,EAAE,EAAC,YAA1B;AAAuC,MAAA,IAAI,EAAC,YAA5C;AAAyD,MAAA,QAAQ,MAAjE;AAAkE,MAAA,QAAQ,EAAE,KAAKC,YAAjF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CAJJ,eAOI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8HADJ,CAPJ,eAUI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADJ,CAVJ,CADJ,CADJ,CADJ;AAoBC;;AAnG8B;;AAsGnC,eAAeX,WAAf","sourcesContent":["import React, { useState, useEffect, Component } from 'react';\r\nimport api from '../services/api';\r\nimport '../styles.css';\r\n\r\nconst cryptography = require('@liskhq/lisk-cryptography');\r\nconst transaction = require(\"@liskhq/lisk-transactions\");\r\nconst FoodRequest = require(\"liskrestaurant_transactions\");\r\n\r\nclass FormPayment extends Component{\r\n    constructor (props){        \r\n\r\n        this.state = {\r\n            passphrase: '',\r\n            orderstring: props.orderstring,\r\n            response: { meta: { status: false }},\r\n        }\r\n    }\r\n    \r\n    handleChange = (event) => {\r\n        let name = event.target.name;\r\n        let val = event.target.value;\r\n        this.state({[name]: val});\r\n    };       \r\n    \r\n    handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n                \r\n        if (this.state.orderstring !== null && orderstring !== undefined){    \r\n            this.state.orderstring = this.state.orderstring.split(\"&\");                                      \r\n        }\r\n\r\n        const username = await api.post(\"/cryptography\", { text: this.state.orderstring[5].split('=')[1] });\r\n        const phone = await api.post(\"/cryptography\", { text: this.state.orderstring[6].split('=')[1] });\r\n        const deliveryaddress = await api.post(\"/cryptography\", { text: this.state.orderstring[7].split('=')[1] });\r\n        const observation = \"\";\r\n        if (this.state.orderstring[8] !== undefined){\r\n            observation = await api.post(\"/cryptography\", { text: this.state.orderstring[8].split('=')[1] });\r\n        }        \r\n        \r\n        const publicKey = cryptography.getPrivateAndPublicKeyFromPassphrase(this.state.passphrase).publicKey;\r\n\r\n        const clientData = cryptography.encryptMessageWithPassphrase(\r\n            this.state.orderstring[5].split('=')[1].concat(' ***Field*** ')\r\n            .concat(this.state.orderstring[6].split('=')[1]).concat(' ***Field*** ')\r\n            .concat(this.state.orderstring[7].split('=')[1]).concat(' ***Field*** ')\r\n            .concat(this.state.orderstring[8].split('=')[1]),\r\n            passphrase,\r\n            publicKey\r\n            );                            \r\n\r\n        const networkIdentifier = cryptography.getNetworkIdentifier(\r\n            \"23ce0366ef0a14a91e5fd4b1591fc880ffbef9d988ff8bebf8f3666b0c09597d\",\r\n            \"Lisk\",\r\n        );       \r\n\r\n        //const encryptedclient= cryptography.encryptMessageWithPassphrase(passphrase, passphrase, orderstring[9].split('=')[1]);\r\n\r\n        const txFood = new FoodRequest({\r\n            asset: {\r\n                name: this.state.orderstring[2].split('=')[1],\r\n                description: this.state.orderstring[2].split('=')[1],\r\n                username: username.data.response,\r\n                phone: phone.data.response,\r\n                deliveryaddress: deliveryaddress.data.response,\r\n                foodType: this.state.orderstring[3].split('=')[1],\r\n                observation: observation.data !== undefined ? observation.data.response : \"\",\r\n                clientData: clientData.encryptedMessage,\r\n                clientNonce: clientData.nonce,\r\n                amount: this.state.orderstring[1].split('=')[1].toString(),\r\n                recipientId: this.state.orderstring[0].split('=')[1], //restaurant lisk address\r\n                //key: encryptedclient.encryptedMessage,\r\n                //keynonce: encryptedclient.nonce,\r\n                clientpublickey: cryptography.getAddressAndPublicKeyFromPassphrase(this.state.passphrase).publicKey\r\n            },                \r\n            timestamp: transaction.utils.getTimeFromBlockchainEpoch(new Date()),\r\n            networkIdentifier: networkIdentifier\r\n        });             \r\n\r\n        txFood.sign(this.state.passphrase);                \r\n\r\n        await onSubmit({         \r\n            txFood            \r\n        });\r\n                       \r\n    }    \r\n\r\n    render() {\r\n    return (\r\n        <div id=\"app\">\r\n            <div id=\"content\" align=\"center\">                \r\n                <form onSubmit={handleSubmit}>                                  \r\n                    <div>\r\n                        <label>Your Lisk Passphrase</label>\r\n                    </div>\r\n                    <div>\r\n                        <input type=\"password\" id=\"passphrase\" name=\"passphrase\" required onChange={this.handleChange}/>\r\n                    </div>\r\n                    <div>\r\n                        <label>copy this passphrase and test above if desired: creek own stem final gate scrub live shallow stage host concert they</label>\r\n                    </div>\r\n                    <div>\r\n                        <button type=\"submit\">Order</button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n    }\r\n}\r\n\r\nexport default FormPayment;\r\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\davin.DESKTOP-83VQBDE\\\\Documents\\\\restaurant_sidechain\\\\web\\\\src\\\\components\\\\FoodOrderPayment.js\";\nimport React, { useState, useEffect } from 'react';\nimport ReactDOM from 'react-dom';\nimport api from '../services/api';\nimport FormPayment from './FormPayment';\nimport '../styles.css';\n\nconst liskCryptography = require('@liskhq/lisk-cryptography');\n\nconst liskTransactions = require('@liskhq/lisk-transactions');\n\nconst FoodRequest = require('liskrestaurant_transactions');\n\nfunction FoodOrderPayment(props) {\n  var [order, setOrder] = useState([]);\n\n  async function getPublicKeyFromPassphrase(passphrase) {\n    return liskCryptography.getAddressAndPublicKeyFromPassphrase(passphrase).publicKey;\n  }\n\n  async function handleSubmit(data) {\n    var food = {};\n    var orderstring = props.orderstring;\n\n    if (orderstring !== null && orderstring !== undefined) {\n      orderstring = orderstring.split(\"&\");\n      food.recipientAddress = orderstring[0].split('=')[1];\n      food.amount = orderstring[1].split('=')[1];\n      food.name = orderstring[2].split('=')[1];\n      food.foodtype = orderstring[3].split('=')[1];\n      food.timestamp = orderstring[4].split('=')[1];\n      food.username = orderstring[5].split('=')[1];\n      food.phone = orderstring[6].split('=')[1];\n      food.deliveryaddress = orderstring[7].split('=')[1];\n    }\n\n    var txFood = new FoodRequest({\n      asset: {\n        name: food.name,\n        description: food.name,\n        username: food.username,\n        phone: food.phone,\n        deliveryaddress: food.deliveryaddress,\n        foodType: food.foodtype\n      },\n      amount: food.amount,\n      senderPublicKey: getPublicKeyFromPassphrase(data),\n      recipientId: food.address,\n      timestamp: food.timestamp\n    });\n    console.log(\"transaction created\");\n    txFood.sign(data);\n    console.log(\"signed transaction\");\n    let preparedTxn = liskTransactions.utils.prepareTransaction(txFood, data);\n    let {\n      signature,\n      signSignature,\n      ...transactionToHash\n    } = preparedTxn;\n    let txnHash = liskCryptography.hash(liskTransactions.utils.getTransactionBytes(transactionToHash));\n    liskCryptography.signData(txnHash, data);\n    order = await api.post('/payment', JSON.stringify({\n      transaction: preparedTxn,\n      networkid: \"identifier\"\n    }));\n    setOrder(order);\n    /*const transaction_result = (\r\n        <div className=\"recipes_topic\">                    \r\n            Testing             \r\n            <div className=\"clear\"></div>\r\n        </div>\r\n    )*/\n\n    const transaction_result = /*#__PURE__*/React.createElement(\"div\", {\n      className: \"recipes_topic\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 13\n      }\n    }, \"Transaction result: \", order.data.status, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }\n    }), \"Transaction id: \", order.data.response.transaction.id, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }\n    }), \"Paid Amount: LSK \", order.data.response.transaction.amount / 100000000, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 17\n      }\n    }), \"Payer LSK address: \", order.data.response.transaction.senderId, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }\n    }), \"Restaurant LSK address: \", order.data.response.transaction.recipientId, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 17\n      }\n    }), \"Broadcast info: \", order.data.response.broadcastInfo.data.message, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clear\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }\n    }));\n    ReactDOM.render(transaction_result, document.getElementById('content'));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"app\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"content\",\n    align: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FormPayment, {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 17\n    }\n  })));\n}\n\nexport default FoodOrderPayment;","map":{"version":3,"sources":["C:/Users/davin.DESKTOP-83VQBDE/Documents/restaurant_sidechain/web/src/components/FoodOrderPayment.js"],"names":["React","useState","useEffect","ReactDOM","api","FormPayment","liskCryptography","require","liskTransactions","FoodRequest","FoodOrderPayment","props","order","setOrder","getPublicKeyFromPassphrase","passphrase","getAddressAndPublicKeyFromPassphrase","publicKey","handleSubmit","data","food","orderstring","undefined","split","recipientAddress","amount","name","foodtype","timestamp","username","phone","deliveryaddress","txFood","asset","description","foodType","senderPublicKey","recipientId","address","console","log","sign","preparedTxn","utils","prepareTransaction","signature","signSignature","transactionToHash","txnHash","hash","getTransactionBytes","signData","post","JSON","stringify","transaction","networkid","transaction_result","status","response","id","senderId","broadcastInfo","message","render","document","getElementById"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport api from '../services/api';\r\nimport FormPayment from './FormPayment';\r\nimport '../styles.css';\r\nconst liskCryptography = require('@liskhq/lisk-cryptography');\r\nconst liskTransactions = require('@liskhq/lisk-transactions');\r\nconst FoodRequest = require('liskrestaurant_transactions');\r\n\r\nfunction FoodOrderPayment(props){                   \r\n    \r\n    var [order, setOrder] = useState([]);                    \r\n\r\n    async function  getPublicKeyFromPassphrase(passphrase) {\r\n        return liskCryptography.getAddressAndPublicKeyFromPassphrase(passphrase).publicKey;\r\n    }\r\n\r\n    async function handleSubmit(data){      \r\n\r\n        var food = {};\r\n        var orderstring = props.orderstring;\r\n        if (orderstring !== null && orderstring !== undefined){    \r\n            orderstring = orderstring.split(\"&\");\r\n                \r\n            food.recipientAddress = orderstring[0].split('=')[1];\r\n            food.amount = orderstring[1].split('=')[1];\r\n            food.name = orderstring[2].split('=')[1];\r\n            food.foodtype = orderstring[3].split('=')[1];\r\n            food.timestamp = orderstring[4].split('=')[1];\r\n            food.username = orderstring[5].split('=')[1];\r\n            food.phone = orderstring[6].split('=')[1];\r\n            food.deliveryaddress = orderstring[7].split('=')[1];\r\n        }                        \r\n        \r\n         \r\n\r\n        var txFood = new FoodRequest({\r\n            asset: {\r\n                name: food.name,\r\n                description: food.name,\r\n                username: food.username,\r\n                phone: food.phone,\r\n                deliveryaddress: food.deliveryaddress,\r\n                foodType: food.foodtype\r\n            },            \r\n            amount: food.amount,\r\n            senderPublicKey: getPublicKeyFromPassphrase(data),\r\n            recipientId: food.address,\r\n            timestamp: food.timestamp\r\n        });\r\n        \r\n        console.log(\"transaction created\");\r\n\r\n        txFood.sign(data);\r\n\r\n        console.log(\"signed transaction\");\r\n\r\n        let preparedTxn = liskTransactions.utils.prepareTransaction(txFood, data);\r\n        let {signature, signSignature, ...transactionToHash} = preparedTxn;\r\n        let txnHash = liskCryptography.hash(liskTransactions.utils.getTransactionBytes(transactionToHash));\r\n        liskCryptography.signData(txnHash, data);\r\n        \r\n        order = await api.post('/payment', JSON.stringify({ transaction: preparedTxn, networkid: \"identifier\"}) );   \r\n        setOrder(order);    \r\n        \r\n        /*const transaction_result = (\r\n            <div className=\"recipes_topic\">                    \r\n                Testing             \r\n                <div className=\"clear\"></div>\r\n            </div>\r\n        )*/\r\n\r\n        const transaction_result = (\r\n            <div className=\"recipes_topic\">                    \r\n                Transaction result: {order.data.status}\r\n                <br />\r\n                Transaction id: {order.data.response.transaction.id}\r\n                <br/>\r\n                Paid Amount: LSK {order.data.response.transaction.amount/100000000}\r\n                <br/>\r\n                Payer LSK address: {order.data.response.transaction.senderId}\r\n                <br/>\r\n                Restaurant LSK address: {order.data.response.transaction.recipientId}\r\n                <br/>\r\n                Broadcast info: {order.data.response.broadcastInfo.data.message}                \r\n                <div className=\"clear\"></div>\r\n            </div>\r\n        );\r\n\r\n        ReactDOM.render(transaction_result, document.getElementById('content'));        \r\n    }        \r\n\r\n    return (\r\n        <div id=\"app\">\r\n            <div id=\"content\" align=\"center\">                \r\n                <FormPayment onSubmit={handleSubmit}></FormPayment>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default FoodOrderPayment;"]},"metadata":{},"sourceType":"module"}